(function(){$(function(){if(!window.File&&!window.FileReader&&!window.FileList&&!window.Blob){alert("The File APIs are not fully supported in this browser.");return}if(!$("body").find("#pixiOverlay").length){$("body").append('<div id="pixiOverlay" style="height:'+$(document).height()+'px"></div>')}var g=$("#pixiOverlay");if(localStorage.getItem("pixiImage")){d()}g.on("dragover",function(i){i.stopPropagation();i.preventDefault();var h=i.originalEvent.dataTransfer;h.dropEffect="copy";g.addClass("pixiOver")});g.on("dragleave",function(h){g.removeClass("pixiOver")});g.on("drop",function(j){j.stopPropagation();j.preventDefault();var i=j.originalEvent.dataTransfer;var k=i.files;g.removeClass("pixiOver");var h=new FileReader();h.readAsDataURL(k[0]);h.onload=function(){localStorage.setItem("pixiImage",this.result);d()}});var b=false,c=false;if($("body #pixiOverlay")){g.on("mousedown",function(h){b=true});g.on("mousemove",function(h){if($("#pixiOverlay").hasClass("hasItem")&&b&&c&&$("#pixiOverlay").is(":visible")){a(h)}});g.on("mouseup",function(h){b=false;g.css("cursor","default")})}function d(){var h=localStorage.getItem("pixiImage");var j=localStorage.getItem("pixiPos");var i=localStorage.getItem("pixiOpacity")||1;g.css({"background-repeat":"no-repeat","background-image":"url("+h+")","background-position":j,opacity:i});g.addClass("hasItem")}var e=$(window).width(),f=$(window).height();function a(h){var j=h.clientX;var i=h.clientY;if(j<e&&i<f){g.css("background-position",""+j+"px "+i+"px");localStorage.setItem("pixiPos",""+j+"px "+i+"px");g.css("cursor","move")}}$(document).keydown(function(k){var l=parseInt($("#pixiOverlay").css("background-position").split(" ")[0].replace("px",""));var h=parseInt($("#pixiOverlay").css("background-position").split(" ")[1].replace("px",""));var m=0;var j=k.keyCode||k.which,i={left:37,up:38,right:39,down:40,grid:71,zindex:90,shift:16,see:80,opacity:[48,49,50,51,52,53,54,55,56,57]};console.log(j);switch(j){case i.left:l--;$("#pixiOverlay").css("background-position",""+l+"px "+h+"px");break;case i.up:h--;$("#pixiOverlay").css("background-position",""+l+"px "+h+"px");break;case i.right:l++;$("#pixiOverlay").css("background-position",""+l+"px "+h+"px");break;case i.down:h++;$("#pixiOverlay").css("background-position",""+l+"px "+h+"px");break;case i.grid:$("#pixiOverlay").toggleClass("pixiToggle");break;case i.zindex:$("#pixiOverlay").toggleClass("lowZindex");break;case i.shift:c=true;break;case i.see:$("#pixiOverlay").toggleClass("pointerDisable");break;default:if(j>=48&&j<=57){$.each(i.opacity,function(n,o){if(i.opacity[n]===j){m=n/10||1;$("#pixiOverlay").css("opacity",m);localStorage.setItem("pixiOpacity",m)}})}break}localStorage.setItem("pixiPos",""+l+"px "+h+"px")});$(document).keyup(function(i){var h=i.keyCode||i.which;if(h==16){c=false}})})})();